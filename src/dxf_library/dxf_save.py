# -*- coding: utf-8; -*-
from save_file import saver
from math import pi
from copy import copy
import codecs


class Dxfer(saver):
    def __init__(self, parent):
        saver.__init__(self, parent)
        self.handle = 'BA'
        self._OBLIQUE = False
        def hand():
            self.handle = format(int(self.handle,16) + 1, '02x').upper()
            if self.handle in ('BD', '105'):
                self.handle = format(int(self.handle,16) + 1, '02x').upper()
            
        self.HENDLE_CLASS_LAYERS = """  0
SECTION
  2
HEADER
  9
$ACADVER
  1
AC1015
  9
$ACADMAINTVER
 70
     6
  9
$DWGCODEPAGE
  3
ANSI_1251
  9
$INSBASE
 10
0.0
 20
0.0
 30
0.0
  9
$EXTMIN
 10
1.000000000000000E+20
 20
1.000000000000000E+20
 30
1.000000000000000E+20
  9
$EXTMAX
 10
-1.000000000000000E+20
 20
-1.000000000000000E+20
 30
-1.000000000000000E+20
  9
$LIMMIN
 10
0.0
 20
0.0
  9
$LIMMAX
 10
420.0
 20
297.0
  9
$ORTHOMODE
 70
     0
  9
$REGENMODE
 70
     1
  9
$FILLMODE
 70
     1
  9
$QTEXTMODE
 70
     0
  9
$MIRRTEXT
 70
     0
  9
$LTSCALE
 40
1.0
  9
$ATTMODE
 70
     1
  9
$TEXTSIZE
 40
350.0
  9
$TRACEWID
 40
1.0
  9
$TEXTSTYLE
  7
Standard
  9
$CLAYER
  8
0
  9
$CELTYPE
  6
ByLayer
  9
$CECOLOR
 62
   256
  9
$CELTSCALE
 40
1.0
  9
$DISPSILH
 70
     0
  9
$DIMSCALE
 40
1.0
  9
$DIMASZ
 40
200.0
  9
$DIMEXO
 40
2.0
  9
$DIMDLI
 40
100.0
  9
$DIMRND
 40
0.0
  9
$DIMDLE
 40
0.0
  9
$DIMEXE
 40
200.0
  9
$DIMTP
 40
0.0
  9
$DIMTM
 40
0.0
  9
$DIMTXT
 40
350.0
  9
$DIMCEN
 40
2.5
  9
$DIMTSZ
 40
0.0
  9
$DIMTOL
 70
     0
  9
$DIMLIM
 70
     0
  9
$DIMTIH
 70
     0
  9
$DIMTOH
 70
     0
  9
$DIMSE1
 70
     0
  9
$DIMSE2
 70
     0
  9
$DIMTAD
 70
     1
  9
$DIMZIN
 70
     8
  9
$DIMBLK
  1

  9
$DIMASO
 70
     1
  9
$DIMSHO
 70
     1
  9
$DIMPOST
  1

  9
$DIMAPOST
  1

  9
$DIMALT
 70
     0
  9
$DIMALTD
 70
     3
  9
$DIMALTF
 40
0.03937007874016
  9
$DIMLFAC
 40
1.0
  9
$DIMTOFL
 70
     1
  9
$DIMTVP
 40
0.0
  9
$DIMTIX
 70
     0
  9
$DIMSOXD
 70
     0
  9
$DIMSAH
 70
     0
  9
$DIMBLK1
  1

  9
$DIMBLK2
  1

  9
$DIMSTYLE
  2
ISO-25
  9
$DIMCLRD
 70
     0
  9
$DIMCLRE
 70
     0
  9
$DIMCLRT
 70
     0
  9
$DIMTFAC
 40
1.0
  9
$DIMGAP
 40
100.0
  9
$DIMJUST
 70
     0
  9
$DIMSD1
 70
     0
  9
$DIMSD2
 70
     0
  9
$DIMTOLJ
 70
     0
  9
$DIMTZIN
 70
     8
  9
$DIMALTZ
 70
     0
  9
$DIMALTTZ
 70
     0
  9
$DIMUPT
 70
     0
  9
$DIMDEC
 70
     0
  9
$DIMTDEC
 70
     2
  9
$DIMALTU
 70
     2
  9
$DIMALTTD
 70
     3
  9
$DIMTXSTY
  7
Standard
  9
$DIMAUNIT
 70
     0
  9
$DIMADEC
 70
     0
  9
$DIMALTRND
 40
0.0
  9
$DIMAZIN
 70
     0
  9
$DIMDSEP
 70
    46
  9
$DIMATFIT
 70
     3
  9
$DIMFRAC
 70
     0
  9
$DIMLDRBLK
  1

  9
$DIMLUNIT
 70
     2
  9
$DIMLWD
 70
    -2
  9
$DIMLWE
 70
    -2
  9
$DIMTMOVE
 70
     0
  9
$LUNITS
 70
     2
  9
$LUPREC
 70
     3
  9
$SKETCHINC
 40
1.0
  9
$FILLETRAD
 40
10.0
  9
$AUNITS
 70
     0
  9
$AUPREC
 70
     0
  9
$MENU
  1
.
  9
$ELEVATION
 40
0.0
  9
$PELEVATION
 40
0.0
  9
$THICKNESS
 40
0.0
  9
$LIMCHECK
 70
     0
  9
$CHAMFERA
 40
10.0
  9
$CHAMFERB
 40
10.0
  9
$CHAMFERC
 40
20.0
  9
$CHAMFERD
 40
0.0
  9
$SKPOLY
 70
     0
  9
$TDCREATE
 40
2455022.887359514
  9
$TDUCREATE
 40
2455022.637359514
  9
$TDUPDATE
 40
2456833.780451389
  9
$TDUUPDATE
 40
2456833.530451389
  9
$TDINDWG
 40
0.0
  9
$TDUSRTIMER
 40
2456833.52087963
  9
$USRTIMER
 70
     1
  9
$ANGBASE
 50
0.0
  9
$ANGDIR
 70
     0
  9
$PDMODE
 70
     0
  9
$PDSIZE
 40
0.0
  9
$PLINEWID
 40
0.0
  9
$SPLFRAME
 70
     0
  9
$SPLINETYPE
 70
     6
  9
$SPLINESEGS
 70
     8
  9
$HANDSEED
  5
MY_HANDSEED
  9
$SURFTAB1
 70
     6
  9
$SURFTAB2
 70
     6
  9
$SURFTYPE
 70
     6
  9
$SURFU
 70
     6
  9
$SURFV
 70
     6
  9
$UCSBASE
  2

  9
$UCSNAME
  2

  9
$UCSORG
 10
0.0
 20
0.0
 30
0.0
  9
$UCSXDIR
 10
1.0
 20
0.0
 30
0.0
  9
$UCSYDIR
 10
0.0
 20
1.0
 30
0.0
  9
$UCSORTHOREF
  2

  9
$UCSORTHOVIEW
 70
     0
  9
$UCSORGTOP
 10
0.0
 20
0.0
 30
0.0
  9
$UCSORGBOTTOM
 10
0.0
 20
0.0
 30
0.0
  9
$UCSORGLEFT
 10
0.0
 20
0.0
 30
0.0
  9
$UCSORGRIGHT
 10
0.0
 20
0.0
 30
0.0
  9
$UCSORGFRONT
 10
0.0
 20
0.0
 30
0.0
  9
$UCSORGBACK
 10
0.0
 20
0.0
 30
0.0
  9
$PUCSBASE
  2

  9
$PUCSNAME
  2

  9
$PUCSORG
 10
0.0
 20
0.0
 30
0.0
  9
$PUCSXDIR
 10
1.0
 20
0.0
 30
0.0
  9
$PUCSYDIR
 10
0.0
 20
1.0
 30
0.0
  9
$PUCSORTHOREF
  2

  9
$PUCSORTHOVIEW
 70
     0
  9
$PUCSORGTOP
 10
0.0
 20
0.0
 30
0.0
  9
$PUCSORGBOTTOM
 10
0.0
 20
0.0
 30
0.0
  9
$PUCSORGLEFT
 10
0.0
 20
0.0
 30
0.0
  9
$PUCSORGRIGHT
 10
0.0
 20
0.0
 30
0.0
  9
$PUCSORGFRONT
 10
0.0
 20
0.0
 30
0.0
  9
$PUCSORGBACK
 10
0.0
 20
0.0
 30
0.0
  9
$USERI1
 70
     0
  9
$USERI2
 70
     0
  9
$USERI3
 70
     0
  9
$USERI4
 70
     0
  9
$USERI5
 70
     0
  9
$USERR1
 40
0.0
  9
$USERR2
 40
0.0
  9
$USERR3
 40
0.0
  9
$USERR4
 40
0.0
  9
$USERR5
 40
0.0
  9
$WORLDVIEW
 70
     1
  9
$SHADEDGE
 70
     3
  9
$SHADEDIF
 70
    70
  9
$TILEMODE
 70
     1
  9
$MAXACTVP
 70
    64
  9
$PINSBASE
 10
0.0
 20
0.0
 30
0.0
  9
$PLIMCHECK
 70
     0
  9
$PEXTMIN
 10
1.000000000000000E+20
 20
1.000000000000000E+20
 30
1.000000000000000E+20
  9
$PEXTMAX
 10
-1.000000000000000E+20
 20
-1.000000000000000E+20
 30
-1.000000000000000E+20
  9
$PLIMMIN
 10
0.0
 20
0.0
  9
$PLIMMAX
 10
0.0
 20
0.0
  9
$UNITMODE
 70
     0
  9
$VISRETAIN
 70
     1
  9
$PLINEGEN
 70
     0
  9
$PSLTSCALE
 70
     1
  9
$TREEDEPTH
 70
  3020
  9
$CMLSTYLE
  2
Standard
  9
$CMLJUST
 70
     0
  9
$CMLSCALE
 40
20.0
  9
$PROXYGRAPHICS
 70
     1
  9
$MEASUREMENT
 70
     1
  9
$CELWEIGHT
370
    -1
  9
$ENDCAPS
280
     0
  9
$JOINSTYLE
280
     0
  9
$LWDISPLAY
290
     0
  9
$INSUNITS
 70
     4
  9
$HYPERLINKBASE
  1

  9
$STYLESHEET
  1

  9
$XEDIT
290
     1
  9
$CEPSNTYPE
380
     0
  9
$PSTYLEMODE
290
     1
  9
$FINGERPRINTGUID
  2
{EC6BB858-51AA-46EC-B484-6C9CC7AB3E2E}
  9
$VERSIONGUID
  2
{FAEB1C32-E019-11D5-929B-00C0DF256EC4}
  9
$EXTNAMES
290
     1
  9
$PSVPSCALE
 40
0.0
  9
$OLESTARTUP
290
     0
  0
ENDSEC
  0
SECTION
  2
CLASSES
  0
CLASS
  1
ACDBDICTIONARYWDFLT
  2
AcDbDictionaryWithDefault
  3
ObjectDBX Classes
 90
        0
280
     0
281
     0
  0
CLASS
  1
VISUALSTYLE
  2
AcDbVisualStyle
  3
ObjectDBX Classes
 90
     4095
280
     0
281
     0
  0
CLASS
  1
TABLESTYLE
  2
AcDbTableStyle
  3
ObjectDBX Classes
 90
     4095
280
     0
281
     0
  0
CLASS
  1
DICTIONARYVAR
  2
AcDbDictionaryVar
  3
ObjectDBX Classes
 90
        0
280
     0
281
     0
  0
CLASS
  1
SCALE
  2
AcDbScale
  3
ObjectDBX Classes
 90
     1153
280
     0
281
     0
  0
CLASS
  1
CELLSTYLEMAP
  2
AcDbCellStyleMap
  3
ObjectDBX Classes
 90
     1152
280
     0
281
     0
  0
CLASS
  1
RASTERVARIABLES
  2
AcDbRasterVariables
  3
ISM
 90
        0
280
     0
281
     0
  0
CLASS
  1
MATERIAL
  2
AcDbMaterial
  3
ObjectDBX Classes
 90
     1153
280
     0
281
     0
  0
CLASS
  1
SUN
  2
AcDbSun
  3
SCENEOE
 90
     1153
280
     0
281
     0
  0
CLASS
  1
ACDBPLACEHOLDER
  2
AcDbPlaceHolder
  3
ObjectDBX Classes
 90
        0
280
     0
281
     0
  0
CLASS
  1
LAYOUT
  2
AcDbLayout
  3
ObjectDBX Classes
 90
        0
280
     0
281
     0
  0
ENDSEC
  0
SECTION
  2
TABLES
  0
TABLE
  2
VPORT
  5
8
330
0
100
AcDbSymbolTable
 70
     1
  0
VPORT
  5
29
330
8
100
AcDbSymbolTableRecord
100
AcDbViewportTableRecord
  2
*Active
 70
     0
 10
0.0
 20
0.0
 11
1.0
 21
1.0
 12
4567.945342688919
 22
-290.378497865131
 13
0.0
 23
0.0
 14
10.0
 24
10.0
 15
10.0
 25
10.0
 16
0.0
 26
0.0
 36
1.0
 17
-134.1869158878508
 27
0.0
 37
0.0
 40
8758.433978073293
 41
1.871915393654524
 42
50.0
 43
0.0
 44
0.0
 50
0.0
 51
0.0
 71
    16
 72
  1000
 73
     1
 74
     3
 75
     0
 76
     0
 77
     0
 78
     0
281
     0
 65
     1
110
0.0
120
0.0
130
0.0
111
1.0
121
0.0
131
0.0
112
0.0
122
1.0
132
0.0
 79
     0
146
0.0
  0
ENDTAB
  0
TABLE
  2
LTYPE
  5
5
330
0
100
AcDbSymbolTable
 70
     4
  0
LTYPE
  5
14
330
5
100
AcDbSymbolTableRecord
100
AcDbLinetypeTableRecord
  2
ByBlock
 70
     0
  3

 72
    65
 73
     0
 40
0.0
  0
LTYPE
  5
15
330
5
100
AcDbSymbolTableRecord
100
AcDbLinetypeTableRecord
  2
ByLayer
 70
     0
  3

 72
    65
 73
     0
 40
0.0
  0
LTYPE
  5
16
330
5
100
AcDbSymbolTableRecord
100
AcDbLinetypeTableRecord
  2
Continuous
 70
     0
  3
Solid line
 72
    65
 73
     0
 40
0.0
  0
LTYPE
  5
B7
330
5
100
AcDbSymbolTableRecord
100
AcDbLinetypeTableRecord
  2
CENTER
 70
     0
  3
 Center _____  _  _____  _  _____  _  _____  _ 
 72
    65
 73
     4
 40
50.8
 49
31.75
 74
     0
 49
-6.35
 74
     0
 49
6.35
 74
     0
 49
-6.35
 74
     0
  0
LTYPE
  5
B8
330
5
100
AcDbSymbolTableRecord
100
AcDbLinetypeTableRecord
  2
DASHED
 70
     0
  3
Dashed __  __  __  __  __  __  __  __  __  __  
 72
    65
 73
     2
 40
19.05
 49
12.7
 74
     0
 49
-6.35
 74
     0
  0
LTYPE
  5
B9
330
5
100
AcDbSymbolTableRecord
100
AcDbLinetypeTableRecord
  2
PHANTOM
 70
     0
  3
Phantom _____  _  _  _____  _  _  _____  _  _  
 72
    65
 73
     6
 40
63.50000000000001
 49
31.75
 74
     0
 49
-6.35
 74
     0
 49
6.35
 74
     0
 49
-6.35
 74
     0
 49
6.35
 74
     0
 49
-6.35
 74
     0
  0
ENDTAB
  0
TABLE
  2
LAYER
  5
2
330
0
100
AcDbSymbolTable
 70
     2
  0
LAYER
  5
10
330
2
100
AcDbSymbolTableRecord
100
AcDbLayerTableRecord
  2
0
 70
     0
 62
     7
  6
Continuous
370
    -3
390
F
  0
LAYER
  5
BA
330
2
100
AcDbSymbolTableRecord
100
AcDbLayerTableRecord
  2
Defpoints
 70
     0
 62
     7
  6
Continuous
290
     0
370
    -3
390
F
  0"""
        self.write_list.append(self.HENDLE_CLASS_LAYERS)#1
        self.STYLES = """ENDTAB
  0
TABLE
  2
STYLE
  5
3
330
0
100
AcDbSymbolTable
 70
     1
  0
STYLE
  5
11
330
3
100
AcDbSymbolTableRecord
100
AcDbTextStyleTableRecord
  2
Standard
 70
     0
 40
0.0
 41
0.7
 50
0.0
 71
     0
 42
350
  3
txt
  4

  0
ENDTAB
  0
TABLE
  2
VIEW
  5
6
330
0
100
AcDbSymbolTable
 70
     0
  0
ENDTAB
  0
TABLE
  2
UCS
  5
7
330
0
100
AcDbSymbolTable
 70
     0
  0
ENDTAB
  0
TABLE
  2
APPID
  5
9
330
0
100
AcDbSymbolTable
 70
     1
  0
APPID
  5
12
330
9
100
AcDbSymbolTableRecord
100
AcDbRegAppTableRecord
  2
ACAD
 70
     0
  0
ENDTAB
  0
TABLE
  2
DIMSTYLE
  5
A
330
0
100
AcDbSymbolTable
 70
     1
100
AcDbDimStyleTable
  0
DIMSTYLE
105
27"""
        self.write_list.append(self.STYLES)#2
        self.ACAD_REACTORS = """102
{ACAD_REACTORS
MY_REACTORS
102
}"""
        self.write_list.append(self.ACAD_REACTORS)#3
        self.BLOCK_RECORDS = """330
A
100
AcDbSymbolTableRecord
100
AcDbDimStyleTableRecord
  2
ISO-25
 70
     0
 41
200.0
 42
100.0
 43
100.0
 44
100.0
 46
100.0
 73
     0
 74
     0
 77
     1
 78
     8
140
350.0
141
2.5
143
0.03937007874016
147
50.0
171
     3
172
     1
178
     0
271
     0
272
     2
274
     3
278
    44
283
     0
284
     8
340
11
  0
ENDTAB
  0
TABLE
  2
BLOCK_RECORD
  5
1
330
0
100
AcDbSymbolTable
 70
     3
  0
BLOCK_RECORD
  5
1F
330
1
100
AcDbSymbolTableRecord
100
AcDbBlockTableRecord
  2
*Model_Space
340
22
  0
BLOCK_RECORD
  5
1B
330
1
100
AcDbSymbolTableRecord
100
AcDbBlockTableRecord
  2
*Paper_Space
340
1E
  0
BLOCK_RECORD
  5
23
330
1
100
AcDbSymbolTableRecord
100
AcDbBlockTableRecord
  2
*Paper_Space0
340
26
  0"""
        self.write_list.append(self.BLOCK_RECORDS)#4

        
                
        self.BLOCKS = """ENDTAB
  0
ENDSEC
  0
SECTION
  2
BLOCKS
  0
BLOCK
  5
20
330
1F
100
AcDbEntity
  8
0
100
AcDbBlockBegin
  2
*Model_Space
 70
     0
 10
0.0
 20
0.0
 30
0.0
  3
*Model_Space
  1
*Model_Space
  0
ENDBLK
  5
21
330
1F
100
AcDbEntity
  8
0
100
AcDbBlockEnd
  0
BLOCK
  5
1C
330
1B
100
AcDbEntity
 67
     1
  8
0
100
AcDbBlockBegin
  2
*Paper_Space
 70
     0
 10
0.0
 20
0.0
 30
0.0
  3
*Paper_Space
  1
*Paper_Space
  0
ENDBLK
  5
1D
330
1B
100
AcDbEntity
 67
     1
  8
0
100
AcDbBlockEnd
  0
BLOCK
  5
24
330
23
100
AcDbEntity
  8
0
100
AcDbBlockBegin
  2
*Paper_Space0
 70
     0
 10
0.0
 20
0.0
 30
0.0
  3
*Paper_Space0
  1
*Paper_Space0
  0
ENDBLK
  5
25
330
23
100
AcDbEntity
  8
0
100
AcDbBlockEnd
  0"""
        self.write_list.append(self.BLOCKS)#5
        
        self.Block_end_ENTITIES = """ENDSEC
  0
SECTION
  2
ENTITIES
  0"""
        self.write_list.append(self.Block_end_ENTITIES)#6
        
        self.dim_list = {}
        dim_ind = 0
        def widther(i):
            w = str(self.config_dict[i]['width'])
            if w in ('1', '1.0'):
                self.config_dict[i]['width'] = '20'
            elif w in ('2', '2.0'):
                self.config_dict[i]['width'] = '30'
            elif w in ('3', '3.0'):
                self.config_dict[i]['width'] = '80'
            elif w in ('4', '4.0'):
                self.config_dict[i]['width'] = '158'
            else:
                self.config_dict[i]['width'] = '20'

        def formater(i, z=1):
            e = str(format(z*float(i), '.5f'))
            while 1:
                if e[-1] == 0 and e[-2] != '.':
                    e = e[0:-1]
                else:
                    break
            return e
        for i in self.config_dict:
            if i[0] == 'd':
                hand()
                dim_ind += 1
                self.config_dict[i]['handle'] = self.handle
                self.config_dict[i]['dim_ind'] = 'D' + str(dim_ind)
                y1 = self.config_dict[i]['y1']
                self.config_dict[i]['y1'] = formater(y1, -1)
                y2 = self.config_dict[i]['y2']
                self.config_dict[i]['y2'] = formater(y2, -1)
                y3 = self.config_dict[i]['y3']
                self.config_dict[i]['y3'] = formater(y3, -1)
                x1 = self.config_dict[i]['x1']
                self.config_dict[i]['x1'] = formater(x1)
                x2 = self.config_dict[i]['x2']
                self.config_dict[i]['x2'] = formater(x2)
                x3 = self.config_dict[i]['x3']
                self.config_dict[i]['x3'] = formater(x3)
                vr_s = self.config_dict[i]['vr_s']
                self.config_dict[i]['vr_s'] = formater(vr_s)
                vv_s = self.config_dict[i]['vv_s']
                self.config_dict[i]['vv_s'] = formater(vv_s)
                size = self.config_dict[i]['size']
                self.config_dict[i]['size'] = str(-float(size))
                w_text = self.config_dict[i]['w_text_dim']
                self.config_dict[i]['w_text_dim'] = str(float(w_text)/3.0)
                self.dim_list[self.config_dict[i]['dim_ind']] = copy(self.config_dict)
                
                e = """DIMENSION
  5
%(handle)s
330
1F
100
AcDbEntity
  8
0
62
%(fill)s
100
AcDbDimension
  2
*%(dim_ind)s
 10
%(arrow_point2_x)s
 20
%(arrow_point2_y)s
 30
0.0
 11
%(text_x)s
 21
%(text_y)s
 31
0.0
 70
    160
 71
     5
 42
%(dim_distanse)s
  3
ISO-25
100
AcDbAlignedDimension
 13
%(x1)s
 23
%(y1)s
 33
0.0
 14
%(x2)s
 24
%(y2)s
 34
0.0"""
                e = (e % self.config_dict[i])
                self.write_list[5] += ('\n' + e)
                if float(self.config_dict[i]['angle']) != 0.0:
                    e = """ 50
%(angle)s"""
                    e = (e % self.config_dict[i])
                    self.write_list[5] += ('\n' + e)
                e = """100
AcDbRotatedDimension"""
                e = (e % self.config_dict[i])
                self.write_list[5] += ('\n' + e)
                
                e = """330
%(handle)s"""
                e = (e % self.config_dict[i])
                self.write_list[2] = self.write_list[2].replace('MY_REACTORS', (e + '\n' + 'MY_REACTORS'))
                hand()
                self.config_dict[i]['handle'] = self.handle
                
                e = """BLOCK_RECORD
  5
%(handle)s
330
1
100
AcDbSymbolTableRecord
100
AcDbBlockTableRecord
  2
*%(dim_ind)s
340
0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[3] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = copy(self.handle)
                hand()
                self.config_dict[i]['handle_BLOCK_end'] = copy(self.handle)
                
                e = """BLOCK
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
100
AcDbBlockBegin
  2
*%(dim_ind)s
 70
     1
 10
0.0
 20
0.0
 30
0.0
  3
*%(dim_ind)s
  1
*%(dim_ind)s
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = self.handle
                e = """LINE
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
370
    -2
100
AcDbLine
 10
%(line_1_x1)s
 20
%(line_1_y1)s
 30
0.0
 11
%(line_1_x2)s
 21
%(line_1_y2)s
 31
0.0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = self.handle
                e = """LINE
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
370
    -2
100
AcDbLine
 10
%(line_2_x1)s
 20
%(line_2_y1)s
 30
0.0
 11
%(line_2_x2)s
 21
%(line_2_y2)s
 31
0.0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = self.handle
                e = """LINE
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
370
    -2
100
AcDbLine
 10
%(line_3_x1)s
 20
%(line_3_y1)s
 30
0.0
 11
%(line_3_x2)s
 21
%(line_3_y2)s
 31
0.0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = self.handle
                if self.config_dict[i]['type_arrow'] == 'Arch':    
                    e = """INSERT
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
370
    -2
100
AcDbBlockReference
  2
_OBLIQUE
 10
%(arrow_point1_x)s
 20
%(arrow_point1_y)s
 30
0.0
 41
%(arrow_s)s
 42
%(arrow_s)s
 43
%(arrow_s)s"""
                    e = (e % self.config_dict[i])
                    self.write_list[4] += ('\n' + e)
                    if float(self.config_dict[i]['angle_arrow1']) != 0.0:
                        e = """ 50
%(angle_arrow1)s"""
                        e = (e % self.config_dict[i])
                        self.write_list[4] += ('\n' + e)
                    e = """  0"""
                    self.write_list[4] += ('\n' + e)
                    if self._OBLIQUE == True:
                        e = """331
%(handle2)s"""
                        e = (e % self.config_dict[i])
                        self.block_oblique_record = self.block_oblique_record.replace('MY_BLKREFS', (e + '\n' + 'MY_BLKREFS'))
                        #self.write_list[3] = self.write_list[3].replace('MY_BLKREFS', (e + '\n' + 'MY_BLKREFS'))
                    else:
                        self.config_dict[i]['MY_1_BLKREFS'] = self.handle
                    hand()
                    self.config_dict[i]['handle2'] = self.handle
                    e = """INSERT
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
370
    -2
100
AcDbBlockReference
  2
_OBLIQUE
 10
%(arrow_point2_x)s
 20
%(arrow_point2_y)s
 30
0.0
 41
%(arrow_s)s
 42
%(arrow_s)s
 43
%(arrow_s)s"""
                    e = (e % self.config_dict[i])
                    self.write_list[4] += ('\n' + e)
                    if float(self.config_dict[i]['angle_arrow2']) != 0.0:
                        #print self.config_dict[i]['angle_arrow2']
                        e = """ 50
%(angle_arrow2)s"""
                        e = (e % self.config_dict[i])
                        self.write_list[4] += ('\n' + e)
                    e = """  0"""
                    self.write_list[4] += ('\n' + e)
                    if self._OBLIQUE == True:
                        e = """331
%(handle2)s"""
                        e = (e % self.config_dict[i])
                        self.block_oblique_record = self.block_oblique_record.replace('MY_BLKREFS', (e + '\n' + 'MY_BLKREFS'))
                        #self.write_list[3] = self.write_list[3].replace('MY_BLKREFS', (e + '\n' + 'MY_BLKREFS'))
                    else:
                        self.config_dict[i]['MY_2_BLKREFS'] = copy(self.handle)
                    hand()
                    self.config_dict[i]['handle2'] = self.handle
                    
                else:
                    e = """SOLID
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
100
AcDbTrace
 10
%(arrow_1_x2)s
 20
%(arrow_1_y2)s
 30
0.0
 11
%(arrow_5_x)s
 21
%(arrow_5_y)s
 31
0.0
 12
%(arrow_2_x2)s
 22
%(arrow_2_y2)s
 32
0.0
 13
%(arrow_1_x1)s
 23
%(arrow_1_y1)s
 33
0.0
  0"""
                    e = (e % self.config_dict[i])
                    self.write_list[4] += ('\n' + e)
                    hand()
                    self.config_dict[i]['handle2'] = self.handle
                    e = """SOLID
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
100
AcDbTrace
 10
%(arrow_3_x2)s
 20
%(arrow_3_y2)s
 30
0.0
 11
%(arrow_6_x)s
 21
%(arrow_6_y)s
 31
0.0
 12
%(arrow_4_x2)s
 22
%(arrow_4_y2)s
 32
0.0
 13
%(arrow_3_x1)s
 23
%(arrow_3_y1)s
 33
0.0
  0"""
                    e = (e % self.config_dict[i])
                    self.write_list[4] += ('\n' + e)
                    hand()
                    self.config_dict[i]['handle2'] = self.handle
                e = """MTEXT
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
0
 62
     0
100
AcDbMText
 10
%(text_xx)s
 20
%(text_yy)s
 30
0.0
 40
%(size)s
 41
0.0
 71
     5
 72
     1
  1
%(dim_distanse)s"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                if self.config_dict[i]['ort'] == 'horizontal':
                    
                    e = """ 11
0.0
 21
1.0
 31
0.0"""
                    self.write_list[4] += ('\n' + e)
                e = """ 73
     1
 44
1.0
  0"""
                
                self.write_list[4] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = self.handle
                e = """POINT
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
Defpoints
 62
     0
100
AcDbPoint
 10
%(line_1_x1)s
 20
%(line_1_y1)s
 30
0.0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = self.handle
                e = """POINT
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
Defpoints
 62
     0
100
AcDbPoint
 10
%(line_2_x1)s
 20
%(line_2_y1)s
 30
0.0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                hand()
                self.config_dict[i]['handle2'] = self.handle
                e = """POINT
  5
%(handle2)s
330
%(handle)s
100
AcDbEntity
  8
Defpoints
 62
     0
100
AcDbPoint
 10
%(arrow_point2_x)s
 20
%(arrow_point2_y)s
 30
0.0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                #hand()
                #self.config_dict[i]['handle2'] = self.handle

                e = """ENDBLK
  5
%(handle_BLOCK_end)s
330
%(handle)s
100
AcDbEntity
  8
0
100
AcDbBlockEnd
  0"""
                e = (e % self.config_dict[i])
                self.write_list[4] += ('\n' + e)
                hand()
                    
                if self.config_dict[i]['type_arrow'] == 'Arch':
                    if self._OBLIQUE == False:
                        hand()
                        self.config_dict[i]['handle2'] = copy(self.handle)
                        self._OBLIQUE_BLOCK_RECORDS = {'oblique_records_handle':copy(self.handle)}
                        e = """BLOCK_RECORD
  5
%(handle2)s
330
1
100
AcDbSymbolTableRecord
100
AcDbBlockTableRecord
  2
_OBLIQUE
340
0
102
{BLKREFS
331
%(MY_1_BLKREFS)s
331
%(MY_2_BLKREFS)s
MY_BLKREFS
102
}
  0"""
                        self.block_oblique_record = (e % self.config_dict[i])
                        
                        #self.write_list[3] += ('\n' + e)
                        hand()
                        self._OBLIQUE_BLOCK_RECORDS['handle2'] = self.handle
                        self._OBLIQUE = True

                        e = """BLOCK
  5
%(handle2)s
330
%(oblique_records_handle)s
100
AcDbEntity
  8
0
100
AcDbBlockBegin
  2
_OBLIQUE
 70
     0
 10
0.0
 20
0.0
 30
0.0
  3
_OBLIQUE
  1
_OBLIQUE
  0"""
                        self.block_oblique = (e % self._OBLIQUE_BLOCK_RECORDS)
                        #self.write_list[4] += ('\n' + e)
                        hand()
                        self._OBLIQUE_BLOCK_RECORDS['handle_OBLIQUE_BLOCK'] = copy(self.handle)
                        hand()
                        self._OBLIQUE_BLOCK_RECORDS['handle2'] = self.handle
                        e = """LINE
  5
%(handle2)s
330
%(oblique_records_handle)s
100
AcDbEntity
  8
0
  6
ByBlock
 62
     0
370
    -2
100
AcDbLine
 10
-0.5
 20
-0.5
 30
0.0
 11
0.5
 21
0.5
 31
0.0
  0"""
                        e = (e % self._OBLIQUE_BLOCK_RECORDS)
                        self.block_oblique += ('\n' + e)
                    #hand()
                    #self._OBLIQUE_BLOCK_RECORDS['handle2'] = self.handle
                    
                        e = """ENDBLK
  5
%(handle_OBLIQUE_BLOCK)s
330
%(oblique_records_handle)s
100
AcDbEntity
  8
0
100
AcDbBlockEnd
  0"""
                        e = (e % self._OBLIQUE_BLOCK_RECORDS)
                        self.block_oblique += ('\n' + e)
                    #hand()
                    self.config_dict[i]['oblique_records_handle'] = copy(self._OBLIQUE_BLOCK_RECORDS['oblique_records_handle'])
                    
                    e = """1001
ACAD
1000
DSTYLE
1002
{
1070
   173
1070
     1
1070
   342
1005
0
1070
   344
1005
%(oblique_records_handle)s
1070
   343
1005
%(oblique_records_handle)s
1070
    46
1040
0.0
1070
   278
1070
    46
1070
    44
1040
%(vv_s)s
1070
    42
1040
0.0
1070
   147
1040
%(s)s
1002
}"""
                    e = (e % self.config_dict[i])
                    self.write_list[5] += ('\n' + e)
                else:
                    e = """1001
ACAD
1000
DSTYLE
1002
{
1070
    44
1040
%(vv_s)s
1070
    42
1040
0.0
1070
    41
1040
%(size_arrow)s
1070
   147
1040
%(s)s
1002
}"""
                    
                e = """    0"""
                self.write_list[5] += ('\n' + e)       
                
                
            if i[0] == 'L':
                hand()
                self.config_dict[i]['handle'] = self.handle
                widther(i)
                y1 = self.config_dict[i]['y1']
                self.config_dict[i]['y1'] = formater(y1, -1)
                y2 = self.config_dict[i]['y2']
                self.config_dict[i]['y2'] = formater(y2, -1)
                x1 = self.config_dict[i]['x1']
                self.config_dict[i]['x1'] = formater(x1)
                x2 = self.config_dict[i]['x2']
                self.config_dict[i]['x2'] = formater(x2)
                self.stipples = {'_____________':None,
                         '_ _ _ _ _ _ _':(1,1),
                         '____ _ ____ _':(4,1,1,1),
                         '____ _ _ ____':(4,1,1,1,1,1)}
                if self.config_dict[i]['stipple']:
                    for j in self.stipples:
                        if self.stipples[j]:
                            t = map(lambda x: x*float(self.AL[i]['factor_stip']), self.stipples[j])
                            if t == self.AL[i]['stipple']:
                                stip = j
                                break
                    if stip == '____ _ ____ _':
                        self.config_dict[i]['dash'] = 'CENTER'
                    elif stip == '_ _ _ _ _ _ _':
                        self.config_dict[i]['dash'] = 'DASHED'
                    elif stip == '____ _ _ ____':
                        self.config_dict[i]['dash'] = 'PHANTOM'
                else:
                    self.config_dict[i]['dash'] = 'Continuous'
                    
                e = """LINE
  5
%(handle)s
330
1F
100
AcDbEntity
  8
0
  6
%(dash)s
 62
  %(fill)s
 48
30.0
370
   %(width)s
100
AcDbLine
 10
%(x1)s
 20
%(y1)s
 30
0.0
 11
%(x2)s
 21
%(y2)s
 31
0.0
  0"""
                e = (e % self.config_dict[i])
                self.write_list[5] += ('\n' + e)   
            if i[0] == 'c':
                hand()
                self.config_dict[i]['handle'] = self.handle
                widther(i)
                y0 = self.config_dict[i]['y0']
                self.config_dict[i]['y0'] = formater(y0, -1)
                x0 = self.config_dict[i]['x0']
                self.config_dict[i]['x0'] = formater(x0)
                e = """CIRCLE
5
%(handle)s
330
1F
100
AcDbEntity
  8
0
 62
  %(fill)s
370
   %(width)s
100
AcDbCircle
 10
%(x0)s
 20
%(y0)s
 30
0.0
 40
%(R)s
  0"""
                e = (e % self.config_dict[i])
                self.write_list[5] += ('\n' + e)

            if i[0] == 'a':
                hand()
                self.config_dict[i]['handle'] = self.handle
                widther(i)
                y0 = self.config_dict[i]['y0']
                self.config_dict[i]['y0'] = formater(y0, -1)
                x0 = self.config_dict[i]['x0']
                self.config_dict[i]['x0'] = formater(x0)
                start = self.config_dict[i]['start']
                extent = self.config_dict[i]['extent'] + start
                if extent < start:
                    start = extent
                    extent = self.config_dict[i]['start']
                self.config_dict[i]['start'] = start
                self.config_dict[i]['extent'] = extent
                e = """ARC
5
%(handle)s
330
1F
100
AcDbEntity
8
0
6
ByLayer
62
%(fill)s
370
%(width)s
100
AcDbCircle
10
%(x0)s
20
%(y0)s
40
%(R)s
100
AcDbArc
50
%(start)s
51
%(extent)s
0"""
                e = (e % self.config_dict[i])
                self.write_list[5] += ('\n' + e)


            if i[0] == 't':
                hand()
                self.config_dict[i]['handle'] = self.handle
                y = self.config_dict[i]['y']
                self.config_dict[i]['y'] = formater(y, -1)
                x = self.config_dict[i]['x']
                self.config_dict[i]['x'] = formater(x)
                size = self.config_dict[i]['size']
                self.config_dict[i]['size'] = str(-float(size))
                angle = self.config_dict[i]['angle']
                self.config_dict[i]['angle'] = str(float(angle)*180.0/pi)
                w_text = self.config_dict[i]['w_text']
                self.config_dict[i]['w_text'] = str(float(w_text)/3.0)
                text = self.config_dict[i]['text']
                self.config_dict[i]['text'] = text.encode("cp1251")
                
                e = """TEXT
5
%(handle)s
330
1F
100
AcDbEntity
8
0
62
%(fill)s
100
AcDbText
10
%(x)s
20
%(y)s
30
0.0
40
%(size)s"""
                e = (e % self.config_dict[i])
                self.write_list[5] += ('\n' + e)
                if self.config_dict[i]['angle'] not in ('0.0', '0'):
                    e = """50
%(angle)s"""
                    e = (e % self.config_dict[i])
                    self.write_list[5] += ('\n' + e)
                e = """1
%(text)s
41
%(w_text)s
100
AcDbText
0"""

                e = (e % self.config_dict[i])
                self.write_list[5] += ('\n' + e)
        hand()
        self.h = {'last_handle':self.handle}
        self.OBJECTS = """ENDSEC
  0
SECTION
  2
OBJECTS
  0
DICTIONARY
  5
C
330
0
100
AcDbDictionary
281
     1
  3
ACAD_DETAILVIEWSTYLE
350
B5
  3
ACAD_GROUP
350
D
  3
ACAD_IMAGE_VARS
350
6A
  3
ACAD_LAYOUT
350
1A
  3
ACAD_MLINESTYLE
350
17
  3
ACAD_PLOTSETTINGS
350
19
  3
ACAD_PLOTSTYLENAME
350
E
  3
ACAD_SCALELIST
350
40
  3
ACAD_SECTIONVIEWSTYLE
350
B6
  3
AcDbVariableDictionary
350
3D
  3
APPDATA
350
71
  3
DWGPROPS
350
%(last_handle)s"""
        self.OBJECTS = (self.OBJECTS % self.h)
        self.write_list.append(self.OBJECTS)
        e = """  0
DICTIONARY
  5
B5
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  0
DICTIONARY
  5
D
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  0
RASTERVARIABLES
  5
6A
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbRasterVariables
 90
        0
 70
     1
 71
     1
 72
     1
  0
DICTIONARY
  5
1A
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  3
Model
350
22
  3
Sheet1
350
1E
  3
Sheet2
350
26
  0
DICTIONARY
  5
17
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  3
Standard
350
18
  0
DICTIONARY
  5
19
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  0
ACDBDICTIONARYWDFLT
  5
E
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  3
Normal
350
F
100
AcDbDictionaryWithDefault
340
F
  0
DICTIONARY
  5
40
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  3
A0
350
41
  3
A1
350
42
  3
A2
350
43
  3
A3
350
44
  3
A4
350
45
  3
A5
350
46
  3
A6
350
47
  3
A7
350
48
  3
A8
350
49
  3
A9
350
4A
  3
B0
350
4B
  3
B1
350
4C
  3
B2
350
4D
  3
B3
350
4E
  3
B4
350
4F
  3
B5
350
50
  3
B6
350
51
  3
B7
350
52
  3
B8
350
53
  3
B9
350
54
  3
C0
350
55
  3
C1
350
56
  3
C2
350
57
  3
C3
350
58
  3
C4
350
59
  3
C5
350
5A
  3
C6
350
5B
  3
C7
350
5C
  3
C8
350
5D
  3
C9
350
5E
  3
D0
350
5F
  3
D1
350
60
  3
D2
350
61
  0
DICTIONARY
  5
B6
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  0
DICTIONARY
  5
3D
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  3
HPTRANSPARENCY
350
BD
  0
DICTIONARY
  5
71
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbDictionary
281
     1
  0"""
        self.write_list[6] += ('\n' + e)
        e = """XRECORD
  5
%(last_handle)s
102
{ACAD_REACTORS
330
C
102
}
330
C
100
AcDbXrecord
280
     1
  1
DWGPROPS COOKIE
  2

  3

  4

  6

  7

  8

  9

300
=
301
=
302
=
303
=
304
=
305
=
306
=
307
=
308
=
309
=
 40
0.0
 41
2455022.637359514
 42
2456836.719236111
  1

 90
        0
  0
LAYOUT
  5
22
102
{ACAD_REACTORS
330
1A
102
}
330
1A
100
AcDbPlotSettings
  1

  2
none_device
  4
ISO_A3_(420.00_x_297.00_MM)
  6

 40
7.5
 41
20.0
 42
7.5
 43
20.0
 44
420.0
 45
297.0
 46
20.78282828282826
 47
0.0
 48
0.0
 49
0.0
140
0.0
141
0.0
142
1.0
143
1.155642023346303
 70
  1204
 72
     1
 73
     0
 74
     1
  7
monochrome.ctb
 75
     0
147
0.8653198653198654
148
-134.1869158878504
149
0.0
100
AcDbLayout
  1
Model
 70
     1
 71
     0
 10
0.0
 20
0.0
 11
420.0
 21
297.0
 12
0.0
 22
0.0
 32
0.0
 14
-4378.05165097843
 24
-13966.58744661573
 34
0.0
 15
12217.17664974781
 25
-360.9396126841557
 35
0.0
146
0.0
 13
0.0
 23
0.0
 33
0.0
 16
1.0
 26
0.0
 36
0.0
 17
0.0
 27
1.0
 37
0.0
 76
     0
330
1F
331
29
  0
LAYOUT
  5
1E
102
{ACAD_REACTORS
330
1A
102
}
330
1A
100
AcDbPlotSettings
  1

  2
none_device
  4

  6

 40
0.0
 41
0.0
 42
0.0
 43
0.0
 44
0.0
 45
0.0
 46
0.0
 47
0.0
 48
0.0
 49
0.0
140
0.0
141
0.0
142
1.0
143
1.0
 70
   688
 72
     0
 73
     0
 74
     5
  7

 75
    16
147
1.0
148
0.0
149
0.0
100
AcDbLayout
  1
Sheet1
 70
     1
 71
     1
 10
0.0
 20
0.0
 11
420.0
 21
297.0
 12
0.0
 22
0.0
 32
0.0
 14
1.000000000000000E+20
 24
1.000000000000000E+20
 34
1.000000000000000E+20
 15
-1.000000000000000E+20
 25
-1.000000000000000E+20
 35
-1.000000000000000E+20
146
0.0
 13
0.0
 23
0.0
 33
0.0
 16
1.0
 26
0.0
 36
0.0
 17
0.0
 27
1.0
 37
0.0
 76
     0
330
1B
  0
LAYOUT
  5
26
102
{ACAD_REACTORS
330
1A
102
}
330
1A
100
AcDbPlotSettings
  1

  2
none_device
  4

  6

 40
0.0
 41
0.0
 42
0.0
 43
0.0
 44
0.0
 45
0.0
 46
0.0
 47
0.0
 48
0.0
 49
0.0
140
0.0
141
0.0
142
1.0
143
1.0
 70
   688
 72
     0
 73
     0
 74
     5
  7

 75
    16
147
1.0
148
0.0
149
0.0
100
AcDbLayout
  1
Sheet2
 70
     1
 71
     2
 10
0.0
 20
0.0
 11
0.0
 21
0.0
 12
0.0
 22
0.0
 32
0.0
 14
0.0
 24
0.0
 34
0.0
 15
0.0
 25
0.0
 35
0.0
146
0.0
 13
0.0
 23
0.0
 33
0.0
 16
1.0
 26
0.0
 36
0.0
 17
0.0
 27
1.0
 37
0.0
 76
     0
330
23
  0
MLINESTYLE
  5
18
102
{ACAD_REACTORS
330
17
102
}
330
17
100
AcDbMlineStyle
  2
Standard
 70
     0
  3

 62
   256
 51
90.0
 52
90.0
 71
     2
 49
0.5
 62
   256
  6
BYLAYER
 49
-0.5
 62
   256
  6
BYLAYER
  0
ACDBPLACEHOLDER
  5
F
102
{ACAD_REACTORS
330
E
102
}
330
E
  0
SCALE
  5
41
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:1
140
1.0
141
1.0
290
     1
  0
SCALE
  5
42
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:2
140
1.0
141
2.0
290
     0
  0
SCALE
  5
43
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:4
140
1.0
141
4.0
290
     0
  0
SCALE
  5
44
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:5
140
1.0
141
5.0
290
     0
  0
SCALE
  5
45
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:8
140
1.0
141
8.0
290
     0
  0
SCALE
  5
46
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:10
140
1.0
141
10.0
290
     0
  0
SCALE
  5
47
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:16
140
1.0
141
16.0
290
     0
  0
SCALE
  5
48
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:20
140
1.0
141
20.0
290
     0
  0
SCALE
  5
49
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:30
140
1.0
141
30.0
290
     0
  0
SCALE
  5
4A
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:40
140
1.0
141
40.0
290
     0
  0
SCALE
  5
4B
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:50
140
1.0
141
50.0
290
     0
  0
SCALE
  5
4C
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1:100
140
1.0
141
100.0
290
     0
  0
SCALE
  5
4D
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
2:1
140
2.0
141
1.0
290
     0
  0
SCALE
  5
4E
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
4:1
140
4.0
141
1.0
290
     0
  0
SCALE
  5
4F
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
8:1
140
8.0
141
1.0
290
     0
  0
SCALE
  5
50
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
10:1
140
10.0
141
1.0
290
     0
  0
SCALE
  5
51
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
100:1
140
100.0
141
1.0
290
     0
  0
SCALE
  5
52
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1/128" = 1'-0"
140
0.0078125
141
12.0
290
     0
  0
SCALE
  5
53
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1/64" = 1'-0"
140
0.015625
141
12.0
290
     0
  0
SCALE
  5
54
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1/32" = 1'-0"
140
0.03125
141
12.0
290
     0
  0
SCALE
  5
55
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1/16" = 1'-0"
140
0.0625
141
12.0
290
     0
  0
SCALE
  5
56
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
3/32" = 1'-0"
140
0.09375
141
12.0
290
     0
  0
SCALE
  5
57
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1/8" = 1'-0"
140
0.125
141
12.0
290
     0
  0
SCALE
  5
58
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
3/16" = 1'-0"
140
0.1875
141
12.0
290
     0
  0
SCALE
  5
59
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1/4" = 1'-0"
140
0.25
141
12.0
290
     0
  0
SCALE
  5
5A
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
3/8" = 1'-0"
140
0.375
141
12.0
290
     0
  0
SCALE
  5
5B
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1/2" = 1'-0"
140
0.5
141
12.0
290
     0
  0
SCALE
  5
5C
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
3/4" = 1'-0"
140
0.75
141
12.0
290
     0
  0
SCALE
  5
5D
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1" = 1'-0"
140
1.0
141
12.0
290
     0
  0
SCALE
  5
5E
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1-1/2" = 1'-0"
140
1.5
141
12.0
290
     0
  0
SCALE
  5
5F
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
3" = 1'-0"
140
3.0
141
12.0
290
     0
  0
SCALE
  5
60
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
6" = 1'-0"
140
6.0
141
12.0
290
     0
  0
SCALE
  5
61
102
{ACAD_REACTORS
330
40
102
}
330
40
100
AcDbScale
 70
     0
300
1'-0" = 1'-0"
140
12.0
141
12.0
290
     0
  0
DICTIONARYVAR
  5
BD
102
{ACAD_REACTORS
330
3D
102
}
330
3D
100
DictionaryVariables
280
     0
  1
ByLayer
  0
ENDSEC
  0
EOF"""
        e = (e % self.h)
        self.write_list[6] += ('\n' + e)
        #len_dxf = 0
        #for i in self.write_list:
            #for j in i:
                #if '\n' in j:
                    #len_dxf += 1
        len_dxf = 110000
        if self._OBLIQUE == True:
            self.write_list[3] += ('\n' + self.block_oblique_record)
            self.write_list[4] += ('\n' + self.block_oblique)
        self.write_list[0] = self.write_list[0].replace('MY_HANDSEED', format(len_dxf, '02x').upper())
        self.write_list[2] = self.write_list[2].replace('\nMY_REACTORS', '')
        self.write_list[3] = self.write_list[3].replace('\nMY_BLKREFS', '')
        if not self.dim_list:
            del self.write_list[2]
